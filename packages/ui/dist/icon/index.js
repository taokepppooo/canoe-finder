(()=>{var k=(t,i=[])=>({parts:(...s)=>{if(wt(i))return k(t,s);throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:(...s)=>k(t,[...i,...s]),rename:s=>k(s,i),keys:()=>i,build:()=>[...new Set(i)].reduce((s,e)=>Object.assign(s,{[e]:{selector:[`&[data-scope="${C(t)}"][data-part="${C(e)}"]`,`& [data-scope="${C(t)}"][data-part="${C(e)}"]`].join(", "),attrs:{"data-scope":C(t),"data-part":C(e)}}}),{})}),C=t=>t.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),wt=t=>t.length===0;var st=k("scrollbar").parts("root","custom"),G=st.build();var St=t=>t.nodeType===Node.DOCUMENT_NODE,bt=t=>t!=null&&t===t.window;function xt(t){return St(t)?t:bt(t)?t.document:t?.ownerDocument??document}function it(t){let i={getRootNode:s=>s.getRootNode?.()??document,getDoc:s=>xt(i.getRootNode(s)),getWin:s=>i.getDoc(s).defaultView??window,getActiveElement:s=>i.getDoc(s).activeElement,isActiveElement:(s,e)=>e===i.getActiveElement(s),getById:(s,e)=>i.getRootNode(s).getElementById(e),setValue:(s,e)=>{if(s==null||e==null)return;let n=e.toString();s.value!==n&&(s.value=e.toString())}};return{...i,...t}}var M=it({getRootId:t=>t.ids?.root??`icon:${t.id}`,getCustomId:t=>t.ids?.custom??`icon:${t.id}:custom`,getRootEl:t=>M.getById(t,M.getRootId(t)),getCustomEl:t=>M.getById(t,M.getCustomId(t))});function At(t,i,s){return{rootProps:s.element({...G.root.attrs,id:M.getRootId(t.context),dir:t.context.dir,style:{}}),customProps:s.element({...G.custom.attrs,id:M.getCustomId(t.context),dir:t.context.dir,style:{}})}}var te=Symbol(),Ot=Symbol();var ot=Object.getPrototypeOf,U=new WeakMap,Nt=t=>t&&(U.has(t)?U.get(t):ot(t)===Object.prototype||ot(t)===Array.prototype);var at=t=>Nt(t)&&t[Ot]||null,J=(t,i=!0)=>{U.set(t,i)};var F=!1,Z=t=>typeof t=="object"&&t!==null,j=new WeakMap,L=new WeakSet,Mt=(t=Object.is,i=(a,d)=>new Proxy(a,d),s=a=>Z(a)&&!L.has(a)&&(Array.isArray(a)||!(Symbol.iterator in a))&&!(a instanceof WeakMap)&&!(a instanceof WeakSet)&&!(a instanceof Error)&&!(a instanceof Number)&&!(a instanceof Date)&&!(a instanceof String)&&!(a instanceof RegExp)&&!(a instanceof ArrayBuffer),e=a=>{switch(a.status){case"fulfilled":return a.value;case"rejected":throw a.reason;default:throw a}},n=new WeakMap,r=(a,d,g=e)=>{let y=n.get(a);if(y?.[0]===d)return y[1];let m=Array.isArray(a)?[]:Object.create(Object.getPrototypeOf(a));return J(m,!0),n.set(a,[d,m]),Reflect.ownKeys(a).forEach(b=>{let w=Reflect.get(a,b);L.has(w)?(J(w,!1),m[b]=w):w instanceof Promise?Object.defineProperty(m,b,{get(){return g(w)}}):j.has(w)?m[b]=D(w,g):m[b]=w}),Object.freeze(m)},o=new WeakMap,u=[1,1],f=a=>{if(!Z(a))throw new Error("object required");let d=o.get(a);if(d)return d;let g=u[0],y=new Set,m=(p,h=++u[0])=>{g!==h&&(g=h,y.forEach(l=>l(p,h)))},b=u[1],w=(p=++u[1])=>(b!==p&&!y.size&&(b=p,S.forEach(([h])=>{let l=h[1](p);l>g&&(g=l)})),g),nt=p=>(h,l)=>{let v=[...h];v[1]=[p,...v[1]],m(v,l)},S=new Map,mt=(p,h)=>{if(F&&S.has(p))throw new Error("prop listener already exists");if(y.size){let l=h[3](nt(p));S.set(p,[h,l])}else S.set(p,[h])},rt=p=>{let h=S.get(p);h&&(S.delete(p),h[1]?.())},vt=p=>(y.add(p),y.size===1&&S.forEach(([l,v],P)=>{if(F&&v)throw new Error("remove already exists");let R=l[3](nt(P));S.set(P,[l,R])}),()=>{y.delete(p),y.size===0&&S.forEach(([l,v],P)=>{v&&(v(),S.set(P,[l]))})}),q=Array.isArray(a)?[]:Object.create(Object.getPrototypeOf(a)),V=i(q,{deleteProperty(p,h){let l=Reflect.get(p,h);rt(h);let v=Reflect.deleteProperty(p,h);return v&&m(["delete",[h],l]),v},set(p,h,l,v){let P=Reflect.has(p,h),R=Reflect.get(p,h,v);if(P&&(t(R,l)||o.has(l)&&t(R,o.get(l))))return!0;rt(h),Z(l)&&(l=at(l)||l);let W=l;if(!Object.getOwnPropertyDescriptor(p,h)?.set)if(l instanceof Promise)l.then(O=>{l.status="fulfilled",l.value=O,m(["resolve",[h],O])}).catch(O=>{l.status="rejected",l.reason=O,m(["reject",[h],O])});else{!j.has(l)&&s(l)&&(W=$(l));let O=!L.has(W)&&j.get(W);O&&mt(h,O)}return Reflect.set(p,h,W,v),m(["set",[h],l,R]),!0}});o.set(a,V);let Et=[q,w,r,vt];return j.set(V,Et),Reflect.ownKeys(a).forEach(p=>{let h=Object.getOwnPropertyDescriptor(a,p);h.get||h.set?Object.defineProperty(q,p,h):V[p]=a[p]}),V})=>[f,j,L,t,i,s,e,n,r,o,u],[jt]=Mt();function $(t={}){return jt(t)}function H(t,i,s){let e=j.get(t);F&&!e&&console.warn("Please use proxy object");let n,r=[],o=e[3],u=!1,a=o(d=>{if(r.push(d),s){i(r.splice(0));return}n||(n=Promise.resolve().then(()=>{n=void 0,u&&i(r.splice(0))}))});return u=!0,()=>{u=!1,a()}}function D(t,i){let s=j.get(t);F&&!s&&console.warn("Please use proxy object");let[e,n,r]=s;return r(e,n(),i)}function X(t){return L.add(t),t}function ct(t,i){Object.keys(i).forEach(n=>{if(Object.getOwnPropertyDescriptor(t,n))throw new Error("object property already defined");let r=i[n],{get:o,set:u}=typeof r=="function"?{get:r}:r,f={};f.get=()=>o(D(e)),u&&(f.set=a=>u(e,a)),Object.defineProperty(t,n,f)});let e=$(t);return e}function ut(t,i,s){typeof s.value=="object"&&(s.value=T(s.value)),!s.enumerable||s.get||s.set||!s.configurable||!s.writable||i==="__proto__"?Object.defineProperty(t,i,s):t[i]=s.value}function T(t){if(typeof t!="object")return t;var i=0,s,e,n,r=Object.prototype.toString.call(t);if(r==="[object Object]"?n=Object.create(t.__proto__||null):r==="[object Array]"?n=Array(t.length):r==="[object Set]"?(n=new Set,t.forEach(function(o){n.add(T(o))})):r==="[object Map]"?(n=new Map,t.forEach(function(o,u){n.set(T(u),T(o))})):r==="[object Date]"?n=new Date(+t):r==="[object RegExp]"?n=new RegExp(t.source,t.flags):r==="[object DataView]"?n=new t.constructor(T(t.buffer)):r==="[object ArrayBuffer]"?n=t.slice(0):r.slice(-6)==="Array]"&&(n=new t.constructor(t)),n){for(e=Object.getOwnPropertySymbols(t);i<e.length;i++)ut(n,e[i],Object.getOwnPropertyDescriptor(t,e[i]));for(i=0,e=Object.getOwnPropertyNames(t);i<e.length;i++)Object.hasOwnProperty.call(n,s=e[i])&&n[s]===t[s]||ut(n,s,Object.getOwnPropertyDescriptor(t,s))}return n||t}var Dt=Object.defineProperty,Tt=(t,i,s)=>i in t?Dt(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s,c=(t,i,s)=>(Tt(t,typeof i!="symbol"?i+"":i,s),s);function Pt(t){for(;t.length>0;)t.pop();return t}var ft=(t,...i)=>(typeof t=="function"?t(...i):t)??void 0,x=t=>t,Ct=()=>{};var ht=(()=>{let t=0;return()=>(t++,t.toString(36))})(),Rt=()=>!1,B=t=>Array.isArray(t),I=t=>!(t==null||typeof t!="object"||B(t)),kt=t=>typeof t=="number"&&!Number.isNaN(t),A=t=>typeof t=="string",tt=t=>typeof t=="function",Lt=(t,i)=>Object.prototype.hasOwnProperty.call(t,i);function K(t){if(!_t(t)||t===void 0)return t;let i=Reflect.ownKeys(t).filter(e=>typeof e=="string"),s={};for(let e of i){let n=t[e];n!==void 0&&(s[e]=K(n))}return s}var _t=t=>t&&typeof t=="object"&&t.constructor===Object;function Y(...t){let i=t.length===1?t[0]:t[1],s=t.length===2?t[0]:!0}function z(...t){let i=t.length===1?t[0]:t[1],s=t.length===2?t[0]:!0}function pt(t,...i){for(let s of i){let e=K(s);for(let n in e)I(s[n])?(t[n]||(t[n]={}),pt(t[n],s[n])):t[n]=s[n]}return t}function lt(t){return T(t)}function E(t){return A(t)?{type:t}:t}function N(t){return t?B(t)?t.slice():[t]:[]}function dt(t){return I(t)&&t.predicate!=null}var It=()=>!0;function gt(t,i){return t=t??It,(s,e,n)=>{if(A(t)){let r=i[t];return tt(r)?r(s,e,n):r}return dt(t)?t.predicate(i)(s,e,n):t?.(s,e,n)}}function Q(t,i){return(s,e,n)=>dt(t)?t.predicate(i)(s,e,n):t}function Vt(t){let i=t.computed??x({}),s=t.context??x({}),e=t.initial?t.states?.[t.initial]?.tags:[],n=$({value:t.initial??"",previousValue:"",event:x({}),previousEvent:x({}),context:ct(s,i),done:!1,tags:e??[],hasTag(r){return this.tags.includes(r)},matches(...r){return r.includes(this.value)},can(r){return x(this).nextEvents.includes(r)},get nextEvents(){let r=t.states?.[this.value]?.on??{},o=t?.on??{};return Object.keys({...r,...o})},get changed(){return this.event.value==="machine.init"||!this.previousValue?!1:this.value!==this.previousValue}});return x(n)}function _(t,i){return(s,e)=>{if(kt(t))return t;if(tt(t))return t(s,e);if(A(t)){let n=Number.parseFloat(t);if(!Number.isNaN(n))return n;if(i){let r=i?.[t];return z(r==null,`[@zag-js/core > determine-delay] Cannot determine delay for \`${t}\`. It doesn't exist in \`options.delays\``),tt(r)?r(s,e):r}}}}function Wt(t){return A(t)?{target:t}:t}function Ft(t,i){return(s,e,n)=>N(t).map(Wt).find(r=>gt(r.guard,i)(s,e,n)??r.target??r.actions)}var $t=class{constructor(t,i){c(this,"status","Not Started"),c(this,"state"),c(this,"initialState"),c(this,"initialContext"),c(this,"id"),c(this,"type","machine"),c(this,"activityEvents",new Map),c(this,"delayedEvents",new Map),c(this,"stateListeners",new Set),c(this,"doneListeners",new Set),c(this,"contextWatchers",new Set),c(this,"removeStateListener",Ct),c(this,"parent"),c(this,"children",new Map),c(this,"guardMap"),c(this,"actionMap"),c(this,"delayMap"),c(this,"activityMap"),c(this,"sync"),c(this,"options"),c(this,"config"),c(this,"start",e=>{if(this.state.value="",this.state.tags=[],this.status==="Running")return this;this.status="Running",this.removeStateListener=H(this.state,()=>{this.stateListeners.forEach(a=>{a(this.stateSnapshot)})},this.sync),this.setupContextWatchers(),this.executeActivities(E("machine.start"),N(this.config.activities),"machine.start"),this.executeActions(this.config.entry,E("machine.start"));let n=E("machine.init"),r=I(e)?e.value:e,o=I(e)?e.context:void 0;o&&this.setContext(o);let u={target:r??this.config.initial},f=this.getNextStateInfo(u,n);return this.initialState=f,this.performStateChangeEffects(this.state.value,f,n),this}),c(this,"setupContextWatchers",()=>{let{watch:e}=this.config;if(!e)return;let n=D(this.state.context),r=H(this.state.context,()=>{let o=D(this.state.context);for(let[u,f]of Object.entries(e))(this.options.compareFns?.[u]??Object.is)(n[u],o[u])||this.executeActions(f,this.state.event);n=o});this.contextWatchers.add(r)}),c(this,"stop",()=>{if(this.status!=="Stopped")return this.performExitEffects(this.state.value,E("machine.stop")),this.executeActions(this.config.exit,E("machine.stop")),this.setState(""),this.setEvent("machine.stop"),this.stopStateListeners(),this.stopChildren(),this.stopActivities(),this.stopDelayedEvents(),this.stopContextWatchers(),this.status="Stopped",this}),c(this,"stopStateListeners",()=>{this.removeStateListener(),this.stateListeners.clear()}),c(this,"stopContextWatchers",()=>{this.contextWatchers.forEach(e=>e()),this.contextWatchers.clear()}),c(this,"stopDelayedEvents",()=>{this.delayedEvents.forEach(e=>{e.forEach(n=>n())}),this.delayedEvents.clear()}),c(this,"stopActivities",e=>{e?(this.activityEvents.get(e)?.forEach(n=>n()),this.activityEvents.get(e)?.clear(),this.activityEvents.delete(e)):(this.activityEvents.forEach(n=>{n.forEach(r=>r()),n.clear()}),this.activityEvents.clear())}),c(this,"sendChild",(e,n)=>{let r=E(e),o=ft(n,this.contextSnapshot),u=this.children.get(o);u||z(`[@zag-js/core] Cannot send '${r.type}' event to unknown child`),u.send(r)}),c(this,"stopChild",e=>{this.children.has(e)||z(`[@zag-js/core > stop-child] Cannot stop unknown child ${e}`),this.children.get(e).stop(),this.children.delete(e)}),c(this,"removeChild",e=>{this.children.delete(e)}),c(this,"stopChildren",()=>{this.children.forEach(e=>e.stop()),this.children.clear()}),c(this,"setParent",e=>{this.parent=e}),c(this,"spawn",(e,n)=>{let r=ft(e);return n&&(r.id=n),r.type="machine.actor",r.setParent(this),this.children.set(r.id,x(r)),r.onDone(()=>{this.removeChild(r.id)}).start(),x(X(r))}),c(this,"stopActivity",e=>{if(!this.state.value)return;let n=this.activityEvents.get(this.state.value);n?.get(e)?.(),n?.delete(e)}),c(this,"addActivityCleanup",(e,n,r)=>{e&&(this.activityEvents.has(e)?this.activityEvents.get(e)?.set(n,r):this.activityEvents.set(e,new Map([[n,r]])))}),c(this,"setState",e=>{this.state.previousValue=this.state.value,this.state.value=e;let n=this.getStateNode(e);e==null?Pt(this.state.tags):this.state.tags=N(n?.tags)}),c(this,"setContext",e=>{e&&pt(this.state.context,K(e))}),c(this,"setOptions",e=>{let n=K(e);this.actionMap={...this.actionMap,...n.actions},this.delayMap={...this.delayMap,...n.delays},this.activityMap={...this.activityMap,...n.activities},this.guardMap={...this.guardMap,...n.guards}}),c(this,"getStateNode",e=>{if(e)return this.config.states?.[e]}),c(this,"getNextStateInfo",(e,n)=>{let r=this.determineTransition(e,n),o=!r?.target,u=r?.target??this.state.value,f=this.state.value!==u,a=this.getStateNode(u),g={reenter:!o&&!f&&!r?.internal,transition:r,stateNode:a,target:u,changed:f};return this.log("NextState:",`[${n.type}]`,this.state.value,"---->",g.target),g}),c(this,"getAfterActions",(e,n)=>{let r;return{entry:()=>{r=globalThis.setTimeout(()=>{let o=this.getNextStateInfo(e,this.state.event);this.performStateChangeEffects(this.state.value,o,this.state.event)},n)},exit:()=>{globalThis.clearTimeout(r)}}}),c(this,"getDelayedEventActions",e=>{let n=this.getStateNode(e),r=this.state.event;if(!n||!n.after)return;let o=[],u=[];if(B(n.after)){let f=this.determineTransition(n.after,r);if(!f)return;if(!Lt(f,"delay"))throw new Error(`[@zag-js/core > after] Delay is required for after transition: ${JSON.stringify(f)}`);let d=_(f.delay,this.delayMap)(this.contextSnapshot,r),g=this.getAfterActions(f,d);return o.push(g.entry),u.push(g.exit),{entries:o,exits:u}}if(I(n.after))for(let f in n.after){let a=n.after[f],g=_(f,this.delayMap)(this.contextSnapshot,r),y=this.getAfterActions(a,g);o.push(y.entry),u.push(y.exit)}return{entries:o,exits:u}}),c(this,"executeActions",(e,n)=>{let r=Q(e,this.guardMap)(this.contextSnapshot,n,this.guardMeta);for(let o of N(r)){let u=A(o)?this.actionMap?.[o]:o;Y(A(o)&&!u,`[@zag-js/core > execute-actions] No implementation found for action: \`${o}\``),u?.(this.state.context,n,this.meta)}}),c(this,"executeActivities",(e,n,r)=>{for(let o of n){let u=A(o)?this.activityMap?.[o]:o;if(!u){Y(`[@zag-js/core > execute-activity] No implementation found for activity: \`${o}\``);continue}let f=u(this.state.context,e,this.meta);if(f){let a=A(o)?o:o.name||ht();this.addActivityCleanup(r??this.state.value,a,f)}}}),c(this,"createEveryActivities",(e,n)=>{if(e)if(B(e)){let r=N(e).find(a=>{let d=a.delay,y=_(d,this.delayMap)(this.contextSnapshot,this.state.event);return gt(a.guard,this.guardMap)(this.contextSnapshot,this.state.event,this.guardMeta)??y!=null});if(!r)return;let u=_(r.delay,this.delayMap)(this.contextSnapshot,this.state.event);n(()=>{let a=globalThis.setInterval(()=>{this.executeActions(r.actions,this.state.event)},u);return()=>{globalThis.clearInterval(a)}})}else for(let r in e){let o=e?.[r],f=_(r,this.delayMap)(this.contextSnapshot,this.state.event);n(()=>{let d=globalThis.setInterval(()=>{this.executeActions(o,this.state.event)},f);return()=>{globalThis.clearInterval(d)}})}}),c(this,"setEvent",e=>{this.state.previousEvent=this.state.event,this.state.event=X(E(e))}),c(this,"performExitEffects",(e,n)=>{let r=this.state.value;if(r==="")return;let o=e?this.getStateNode(e):void 0;this.stopActivities(r);let u=Q(o?.exit,this.guardMap)(this.contextSnapshot,n,this.guardMeta),f=N(u),a=this.delayedEvents.get(r);a&&f.push(...a),this.executeActions(f,n)}),c(this,"performEntryEffects",(e,n)=>{let r=this.getStateNode(e),o=N(r?.activities);this.createEveryActivities(r?.every,d=>{o.unshift(d)}),o.length>0&&this.executeActivities(n,o);let u=Q(r?.entry,this.guardMap)(this.contextSnapshot,n,this.guardMeta),f=N(u),a=this.getDelayedEventActions(e);r?.after&&a&&(this.delayedEvents.set(e,a?.exits),f.push(...a.entries)),this.executeActions(f,n),r?.type==="final"&&(this.state.done=!0,this.doneListeners.forEach(d=>{d(this.stateSnapshot)}),this.stop())}),c(this,"performTransitionEffects",(e,n)=>{let r=this.determineTransition(e,n);this.executeActions(r?.actions,n)}),c(this,"performStateChangeEffects",(e,n,r)=>{this.setEvent(r);let o=n.changed||n.reenter;o&&this.performExitEffects(e,r),this.performTransitionEffects(n.transition,r),this.setState(n.target),o&&this.performEntryEffects(n.target,r)}),c(this,"determineTransition",(e,n)=>Ft(e,this.guardMap)?.(this.contextSnapshot,n,this.guardMeta)),c(this,"sendParent",e=>{this.parent||z("[@zag-js/core > send-parent] Cannot send event to an unknown parent");let n=E(e);this.parent?.send(n)}),c(this,"log",(...e)=>{Rt()&&this.options.debug&&console.log(...e)}),c(this,"send",e=>{let n=E(e);this.transition(this.state.value,n)}),c(this,"transition",(e,n)=>{let r=A(e)?this.getStateNode(e):e?.stateNode,o=E(n);if(!r&&!this.config.on){let a=this.status==="Stopped"?"[@zag-js/core > transition] Cannot transition a stopped machine":`[@zag-js/core > transition] State does not have a definition for \`state\`: ${e}, \`event\`: ${o.type}`;Y(a);return}let u=r?.on?.[o.type]??this.config.on?.[o.type],f=this.getNextStateInfo(u,o);return this.performStateChangeEffects(this.state.value,f,o),f.stateNode}),c(this,"subscribe",e=>(this.stateListeners.add(e),this.status==="Running"&&e(this.stateSnapshot),()=>{this.stateListeners.delete(e)})),c(this,"onDone",e=>(this.doneListeners.add(e),this)),c(this,"onTransition",e=>(this.stateListeners.add(e),this.status==="Running"&&e(this.stateSnapshot),this)),this.config=lt(t),this.options=lt(i??{}),this.id=this.config.id??`machine-${ht()}`,this.guardMap=this.options?.guards??{},this.actionMap=this.options?.actions??{},this.delayMap=this.options?.delays??{},this.activityMap=this.options?.activities??{},this.sync=this.options?.sync??!1,this.state=Vt(this.config),this.initialContext=D(this.state.context);let s=E("machine.created");this.executeActions(this.config?.created,s)}get stateSnapshot(){return x(D(this.state))}getState(){return this.stateSnapshot}get contextSnapshot(){return this.stateSnapshot.context}get self(){let t=this;return{id:this.id,send:this.send.bind(this),sendParent:this.sendParent.bind(this),sendChild:this.sendChild.bind(this),stop:this.stop.bind(this),stopChild:this.stopChild.bind(this),spawn:this.spawn.bind(this),stopActivity:this.stopActivity.bind(this),get state(){return t.stateSnapshot},get initialContext(){return t.initialContext},get initialState(){return t.initialState?.target??""}}}get meta(){return{state:this.stateSnapshot,guards:this.guardMap,send:this.send.bind(this),self:this.self,initialContext:this.initialContext,initialState:this.initialState?.target??"",getState:()=>this.stateSnapshot,getAction:t=>this.actionMap[t],getGuard:t=>this.guardMap[t]}}get guardMeta(){return{state:this.stateSnapshot}}get[Symbol.toStringTag](){return"Machine"}},yt=(t,i)=>new $t(t,i);function et(t){if(!zt(t)||t===void 0)return t;let i=Reflect.ownKeys(t).filter(e=>typeof e=="string"),s={};for(let e of i){let n=t[e];n!==void 0&&(s[e]=et(n))}return s}var zt=t=>t&&typeof t=="object"&&t.constructor===Object;function Bt(t){let i=et(t);return yt({id:"icon",initial:"idle",context:{...i},activities:["setInitialSize"],states:{idle:{},focused:{},hover:{}}},{activities:{setInitialSize(s){}},actions:{}})}})();
